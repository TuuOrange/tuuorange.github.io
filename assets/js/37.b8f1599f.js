(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{462:function(t,s,a){t.exports=a.p+"assets/img/rbac_route_step.9ecd9ba7.jpg"},491:function(t,s,a){"use strict";a.r(s);var n=a(2),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"后台管理系统中的目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#后台管理系统中的目录"}},[t._v("#")]),t._v(" 后台管理系统中的目录")]),t._v(" "),s("p",[t._v("在后台管理系统项目中，可以分为三个模块：")]),t._v(" "),s("ul",[s("li",[t._v("用户管理：给用户分配不同的角色以及对用户增删操作")]),t._v(" "),s("li",[t._v("角色管理：给不同的角色分配不同的权限")]),t._v(" "),s("li",[t._v("权限管理：给权限分配菜单，为每个权限调整制定的菜单资源")])]),t._v(" "),s("blockquote",[s("p",[t._v("对于一些用户可以执行"),s("u",[t._v("启用/停用")]),t._v("操作（并没有真正的删除用户），数据库里还保存着用户的信息，这样可以保证在未来数据还想找回的时候，可以直接在数据库中重新启用")])]),t._v(" "),s("h2",{attrs:{id:"导航栏中的权限管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导航栏中的权限管理"}},[t._v("#")]),t._v(" 导航栏中的权限管理")]),t._v(" "),s("h3",{attrs:{id:"路由表配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#路由表配置"}},[t._v("#")]),t._v(" 路由表配置")]),t._v(" "),s("ul",[s("li",[t._v("共有路由表（每个用户都有的路由表， 固定的）")]),t._v(" "),s("li",[t._v("私有路由表（不同的角色拥有不同的路由表，动态的）")])]),t._v(" "),s("h3",{attrs:{id:"实现方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现方法"}},[t._v("#")]),t._v(" 实现方法")]),t._v(" "),s("h4",{attrs:{id:"简单的角色关系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单的角色关系"}},[t._v("#")]),t._v(" 简单的角色关系")]),t._v(" "),s("p",[t._v("如果是简单的项目，且角色关系简单，可以直接使用路由中的 meta。")]),t._v(" "),s("p",[t._v("在 meta 中添加 roles 参数进行识别，在生成路由表时进行角色权限判断。（如果没有权限->403)")]),t._v(" "),s("h4",{attrs:{id:"复杂的角色关系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#复杂的角色关系"}},[t._v("#")]),t._v(" 复杂的角色关系")]),t._v(" "),s("ol",[s("li",[t._v("获取权限数据（后端返回）")]),t._v(" "),s("li",[t._v("私有路由表不再被直接加入到 routes 中")]),t._v(" "),s("li",[t._v("利用"),s("strong",[t._v("addRoute")]),t._v("API 动态添加到路由表 routes 中")])]),t._v(" "),s("p",[t._v("通过路由定义的角色权限（前端输出的所有路由数组）与当前用户的角色（后端返回的 menus 中的路由数组）的 key 比对，"),s("u",[t._v("筛选过滤出有权限的路由")]),t._v("，挂载到 router 上。（生成的角色对应的动态路由需要存放到 "),s("strong",[t._v("store")]),t._v(" 中，方便侧边栏使用）")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[t._v("没有权限访问-> 403[访问被拒绝]\n没有该路由 -> 404[找不到该资源]")])]),s("img",{attrs:{src:a(462),alt:"step"}}),t._v(" "),s("h2",{attrs:{id:"按钮的权限管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#按钮的权限管理"}},[t._v("#")]),t._v(" 按钮的权限管理")]),t._v(" "),s("h3",{attrs:{id:"实现方法-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现方法-2"}},[t._v("#")]),t._v(" 实现方法")]),t._v(" "),s("ol",[s("li",[t._v("获取后端数据")]),t._v(" "),s("li",[t._v("定义隐藏按钮方式（指令）")]),t._v(" "),s("li",[t._v("根据数据判断隐藏按钮")])]),t._v(" "),s("h4",{attrs:{id:"自定义-v-permiss-指令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义-v-permiss-指令"}},[t._v("#")]),t._v(" 自定义 v-permiss 指令：")]),t._v(" "),s("p",[t._v("利用后端返回的"),s("strong",[t._v("points")]),t._v("数组，"),s("strong",[t._v("some")]),t._v("遍历当前元素中的内容（"),s("strong",[t._v("binding.value")]),t._v("）是否包含在 points 数组内，包含则显示触发条件，不包含（false）则删除该子元素不显示（按钮）")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("Vue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("directive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"auth"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("inserted")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" binding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("check")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("binding"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parentNode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parentNode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeChild")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("template"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("btn"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("components v"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("permiss"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"['xxx']\"")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("btn"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("components"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("template"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("p",[t._v("系统的 rbac 角色权限管理，并没有那么困难，只是需要注意的是动态管理路由和添加按钮指令。\n这也教会了我一个思想，在完成一个业务功能的时候，多考虑封装和动态分配；可以结合使用的框架进行优化。")]),t._v(" "),s("blockquote",[s("p",[t._v("可以参考：https://juejin.cn/post/7320044522909548582?searchId=20250421225408FF4861146A51ED6E0611")])])])}),[],!1,null,null,null);s.default=r.exports}}]);